<!DOCTYPE html>
<html>
<head>
</head>
<body>
    <!-- Binaural Audio Section -->
    <!-- Frequency Offset Slider -->
    <input type="range" id="frequencyOffsetSlider" min="0" max="50" value="10">
    <span id="frequencyOffsetDisplay">10</span> <!-- Display the offset value -->

    <!-- Play Button for Binaural Audio -->
    <button id="playButtonBinaural">Play Binaural</button>

    <script>
        let audioContextBinaural;
        let leftOscillator;
        let rightOscillator;

        async function initAudio() {
            if (!audioContextBinaural) {
                audioContextBinaural = new (window.AudioContext || window.webkitAudioContext)();

                // Create the oscillators
                leftOscillator = audioContextBinaural.createOscillator();
                rightOscillator = audioContextBinaural.createOscillator();
                leftOscillator.type = 'sine';
                rightOscillator.type = 'sine';

                // Connect the oscillators
                leftOscillator.connect(audioContextBinaural.destination);
                rightOscillator.connect(audioContextBinaural.destination);
            }

            // Update the frequency offset
            updateFrequencyOffset();
        }

        function startAudio() {
            initAudio();

            // Start the oscillators
            leftOscillator.start();
            rightOscillator.start();
        }

        function stopAudio() {
            // Stop and disconnect the oscillators
            leftOscillator.stop();
            rightOscillator.stop();
            leftOscillator.disconnect();
            rightOscillator.disconnect();
        }

        function updateFrequencyOffset() {
            const offset = parseInt(frequencyOffsetSlider.value);
            frequencyOffsetDisplay.textContent = offset;
            if (leftOscillator && rightOscillator) {
                leftOscillator.frequency.setValueAtTime(440, audioContextBinaural.currentTime);
                rightOscillator.frequency.setValueAtTime(440 + offset, audioContextBinaural.currentTime);
            }
        }

        const frequencyOffsetSlider = document.getElementById('frequencyOffsetSlider');
        const frequencyOffsetDisplay = document.getElementById('frequencyOffsetDisplay');
        const playButtonBinaural = document.getElementById('playButtonBinaural');

        playButtonBinaural.addEventListener('click', function() {
            if (audioContextBinaural && audioContextBinaural.state === 'suspended') {
                audioContextBinaural.resume().then(function() {
                    startAudio();
                });
            } else if (audioContextBinaural && audioContextBinaural.state === 'running') {
                stopAudio();
            } else {
                console.error('Web Audio API is not supported by your browser.');
            }
            playButtonBinaural.textContent = audioContextBinaural.state === 'running' ? 'Stop Binaural' : 'Play Binaural';
        });

        frequencyOffsetSlider.addEventListener('input', updateFrequencyOffset);
    </script>
</body>
</html>
